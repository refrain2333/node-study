# å˜é‡ä¸ä½œç”¨åŸŸ - è¯¦ç»†æ–‡æ¡£

## ğŸ“š ç›®å½•
- [æ¦‚è¿°](#æ¦‚è¿°)
- [åŸºç¡€æ¦‚å¿µ](#åŸºç¡€æ¦‚å¿µ)
- [var vs let vs const](#var-vs-let-vs-const)
- [å—çº§ä½œç”¨åŸŸ](#å—çº§ä½œç”¨åŸŸ)
- [å®é™…åº”ç”¨åœºæ™¯](#å®é™…åº”ç”¨åœºæ™¯)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [å¸¸è§é™·é˜±](#å¸¸è§é™·é˜±)
- [ç»ƒä¹ é¢˜è§£æ](#ç»ƒä¹ é¢˜è§£æ)
- [ä¸ Python çš„å¯¹æ¯”](#ä¸-python-çš„å¯¹æ¯”)

## æ¦‚è¿°

JavaScript çš„å˜é‡å£°æ˜å’Œä½œç”¨åŸŸæœºåˆ¶æ˜¯ç†è§£ç°ä»£ JavaScript å¼€å‘çš„åŸºç¡€ã€‚æœ¬ç« èŠ‚å°†æ·±å…¥æ¢è®¨ `var`ã€`let`ã€`const` çš„åŒºåˆ«ï¼Œå—çº§ä½œç”¨åŸŸçš„æ¦‚å¿µï¼Œä»¥åŠåœ¨å®é™…å¼€å‘ä¸­çš„åº”ç”¨ã€‚

## åŸºç¡€æ¦‚å¿µ

### ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸï¼Ÿ

ä½œç”¨åŸŸï¼ˆScopeï¼‰å†³å®šäº†å˜é‡çš„å¯è®¿é—®æ€§å’Œç”Ÿå‘½å‘¨æœŸã€‚JavaScript ä¸­ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ä½œç”¨åŸŸï¼š

1. **å…¨å±€ä½œç”¨åŸŸ**ï¼šåœ¨æ•´ä¸ªç¨‹åºä¸­éƒ½å¯ä»¥è®¿é—®
2. **å‡½æ•°ä½œç”¨åŸŸ**ï¼šåœ¨å‡½æ•°å†…éƒ¨å£°æ˜çš„å˜é‡
3. **å—çº§ä½œç”¨åŸŸ**ï¼šåœ¨ä»£ç å—ï¼ˆ`{}`ï¼‰å†…å£°æ˜çš„å˜é‡

### å˜é‡æå‡ï¼ˆHoistingï¼‰

JavaScript ä¼šå°†å˜é‡å’Œå‡½æ•°å£°æ˜æå‡åˆ°å…¶ä½œç”¨åŸŸçš„é¡¶éƒ¨ï¼š

```javascript
console.log(a); // undefined (å˜é‡æå‡)
var a = 1;

console.log(b); // ReferenceError: Cannot access 'b' before initialization
let b = 1;
```

## var vs let vs const

### var - å‡½æ•°ä½œç”¨åŸŸ

**ç‰¹ç‚¹ï¼š**
- å‡½æ•°ä½œç”¨åŸŸ
- å¯ä»¥é‡å¤å£°æ˜
- å­˜åœ¨å˜é‡æå‡
- å¯èƒ½é€ æˆå…¨å±€æ±¡æŸ“

```javascript
function varExample() {
    console.log(a); // undefined (å˜é‡æå‡)
    var a = 1;
    
    if (true) {
        var a = 2; // è¦†ç›–å¤–å±‚å˜é‡
    }
    console.log(a); // 2
}
```

**é—®é¢˜ï¼š**
- å¾ªç¯ä¸­çš„å˜é‡é—®é¢˜
- æ„å¤–çš„å…¨å±€å˜é‡åˆ›å»º
- å˜é‡é‡å¤å£°æ˜

### let - å—çº§ä½œç”¨åŸŸ

**ç‰¹ç‚¹ï¼š**
- å—çº§ä½œç”¨åŸŸ
- ä¸èƒ½é‡å¤å£°æ˜
- ä¸å­˜åœ¨å˜é‡æå‡
- å­˜åœ¨æš‚æ—¶æ€§æ­»åŒº

```javascript
function letExample() {
    // console.log(b); // ReferenceError: Cannot access 'b' before initialization
    
    let b = 1;
    if (true) {
        let b = 2; // æ–°çš„å—çº§ä½œç”¨åŸŸ
    }
    console.log(b); // 1
}
```

**ä¼˜åŠ¿ï¼š**
- é¿å…å¾ªç¯å˜é‡é—®é¢˜
- é˜²æ­¢æ„å¤–çš„å…¨å±€å˜é‡
- æ›´å¥½çš„ä»£ç ç»„ç»‡

### const - å¸¸é‡å£°æ˜

**ç‰¹ç‚¹ï¼š**
- å—çº§ä½œç”¨åŸŸ
- å¿…é¡»åˆå§‹åŒ–
- ä¸èƒ½é‡æ–°èµ‹å€¼
- å¯¹è±¡å±æ€§å¯ä¿®æ”¹

```javascript
const c = 1;
// c = 2; // TypeError: Assignment to constant variable.

const obj = { name: "å¼ ä¸‰" };
obj.name = "æå››"; // å¯ä»¥ä¿®æ”¹å±æ€§
// obj = {}; // TypeError: Assignment to constant variable.
```

## å—çº§ä½œç”¨åŸŸ

### ä»€ä¹ˆæ˜¯å—çº§ä½œç”¨åŸŸï¼Ÿ

å—çº§ä½œç”¨åŸŸæ˜¯æŒ‡åœ¨ä»£ç å—ï¼ˆ`{}`ï¼‰å†…å£°æ˜çš„å˜é‡åªåœ¨è¯¥ä»£ç å—å†…æœ‰æ•ˆã€‚

```javascript
{
    let blockVar = "å—çº§å˜é‡";
    const blockConst = "å—çº§å¸¸é‡";
}
// console.log(blockVar); // ReferenceError: blockVar is not defined
```

### å®é™…åº”ç”¨

#### 1. å¾ªç¯ä¸­çš„å˜é‡

**é—®é¢˜ä»£ç ï¼ˆä½¿ç”¨ varï¼‰ï¼š**
```javascript
for (var i = 0; i < 3; i++) {
    setTimeout(() => {
        console.log(i); // éƒ½è¾“å‡º 3
    }, 100);
}
```

**è§£å†³æ–¹æ¡ˆï¼ˆä½¿ç”¨ letï¼‰ï¼š**
```javascript
for (let i = 0; i < 3; i++) {
    setTimeout(() => {
        console.log(i); // è¾“å‡º 0, 1, 2
    }, 100);
}
```

#### 2. æ¡ä»¶è¯­å¥ä¸­çš„å˜é‡

```javascript
if (true) {
    let conditionVar = "æ¡ä»¶å˜é‡";
    // åªåœ¨ if å—å†…å¯è®¿é—®
}
// conditionVar åœ¨è¿™é‡Œä¸å¯è®¿é—®
```

## å®é™…åº”ç”¨åœºæ™¯

### 1. æ¨¡å—æ¨¡å¼

ä½¿ç”¨ IIFEï¼ˆç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼‰åˆ›å»ºç§æœ‰ä½œç”¨åŸŸï¼š

```javascript
const UserModule = (function() {
    let users = []; // ç§æœ‰å˜é‡
    let nextId = 1;
    
    function validateUser(user) { // ç§æœ‰æ–¹æ³•
        return user && user.name && user.email;
    }
    
    return {
        addUser(user) {
            if (validateUser(user)) {
                user.id = nextId++;
                users.push(user);
                return user;
            }
        },
        getUser(id) {
            return users.find(user => user.id === id);
        }
    };
})();
```

### 2. äº‹ä»¶ç›‘å¬å™¨

```javascript
function setupEventListeners() {
    const buttons = document.querySelectorAll('.btn');
    
    for (let i = 0; i < buttons.length; i++) {
        buttons[i].addEventListener('click', function() {
            console.log(`æŒ‰é’® ${i} è¢«ç‚¹å‡»`); // æ­£ç¡®çš„ i å€¼
        });
    }
}
```

### 3. å®‰å…¨çš„è®¡æ•°å™¨

```javascript
function createSafeCounter() {
    let count = 0; // ç§æœ‰å˜é‡
    
    return {
        increment() {
            count++;
            return count;
        },
        decrement() {
            count--;
            return count;
        },
        getCount() {
            return count;
        }
    };
}
```

## æœ€ä½³å®è·µ

### 1. ä¼˜å…ˆä½¿ç”¨ const

```javascript
const API_BASE_URL = "https://api.example.com";
const config = { timeout: 5000 };

// åªæœ‰éœ€è¦é‡æ–°èµ‹å€¼æ—¶æ‰ä½¿ç”¨ let
let currentUser = null;
```

### 2. é¿å…å…¨å±€å˜é‡

```javascript
// âŒ é¿å…
var globalVar = "å…¨å±€å˜é‡";

// âœ… æ¨è
const module = (function() {
    let privateVar = "ç§æœ‰å˜é‡";
    return {
        getPrivateVar: () => privateVar
    };
})();
```

### 3. ä½¿ç”¨å—çº§ä½œç”¨åŸŸ

```javascript
// âŒ é¿å…
for (var i = 0; i < data.length; i++) {
    // å¤„ç†æ•°æ®
}

// âœ… æ¨è
for (let i = 0; i < data.length; i++) {
    // å¤„ç†æ•°æ®
}
```

### 4. åŠæ—¶æ¸…ç†å¼•ç”¨

```javascript
function processData() {
    let largeData = new Array(1000000).fill("data");
    
    const result = largeData.slice(0, 100);
    
    // å¤„ç†å®Œæˆåæ¸…ç†å¤§å¯¹è±¡å¼•ç”¨
    largeData = null;
    
    return result;
}
```

## å¸¸è§é™·é˜±

### 1. æš‚æ—¶æ€§æ­»åŒº

```javascript
console.log(temporalVar); // ReferenceError
let temporalVar = "æš‚æ—¶æ€§æ­»åŒº";
```

### 2. å¾ªç¯é—­åŒ…é—®é¢˜

```javascript
// âŒ é—®é¢˜ä»£ç 
const functions = [];
for (var i = 0; i < 3; i++) {
    functions[i] = function() {
        return i; // éƒ½è¿”å› 3
    };
}

// âœ… è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨ let
const functions2 = [];
for (let i = 0; i < 3; i++) {
    functions2[i] = function() {
        return i; // æ­£ç¡®è¿”å› 0, 1, 2
    };
}

// âœ… è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨ IIFE
const functions3 = [];
for (var i = 0; i < 3; i++) {
    functions3[i] = (function(index) {
        return function() {
            return index;
        };
    })(i);
}
```

### 3. å…¨å±€å˜é‡æ±¡æŸ“

```javascript
// âŒ é¿å…
function badFunction() {
    accidentalGlobal = "å…¨å±€æ±¡æŸ“"; // æ²¡æœ‰å£°æ˜ï¼Œå˜æˆå…¨å±€å˜é‡
}

// âœ… æ¨è
function goodFunction() {
    let localVar = "å±€éƒ¨å˜é‡";
    const constVar = "å¸¸é‡";
}
```

## ç»ƒä¹ é¢˜è§£æ

### ç»ƒä¹ 1ï¼šä¿®å¤å˜é‡ä½œç”¨åŸŸé—®é¢˜

**é—®é¢˜ï¼š** å¾ªç¯ä¸­çš„å˜é‡åœ¨å¼‚æ­¥å›è°ƒä¸­éƒ½è¾“å‡ºç›¸åŒçš„å€¼

**è§£å†³æ–¹æ¡ˆï¼š** ä½¿ç”¨ `let` æ›¿ä»£ `var`

```javascript
// ä¿®å¤å‰
for (var i = 0; i < 3; i++) {
    setTimeout(() => {
        console.log("i =", i); // éƒ½è¾“å‡º 3
    }, 100);
}

// ä¿®å¤å
for (let i = 0; i < 3; i++) {
    setTimeout(() => {
        console.log("i =", i); // è¾“å‡º 0, 1, 2
    }, 100);
}
```

### ç»ƒä¹ 2ï¼šåˆ›å»ºå®‰å…¨çš„è®¡æ•°å™¨

**è¦æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå…·æœ‰ç§æœ‰çŠ¶æ€çš„è®¡æ•°å™¨

```javascript
function createSafeCounter() {
    let count = 0; // ç§æœ‰å˜é‡
    
    return {
        increment() {
            count++;
            return count;
        },
        decrement() {
            count--;
            return count;
        },
        getCount() {
            return count;
        }
    };
}

const counter = createSafeCounter();
console.log(counter.increment()); // 1
console.log(counter.increment()); // 2
console.log(counter.decrement()); // 1
console.log(counter.getCount());  // 1
```

## ä¸ Python çš„å¯¹æ¯”

| ç‰¹æ€§ | Python | JavaScript |
|------|--------|------------|
| å˜é‡å£°æ˜ | `x = 1` | `let x = 1` |
| å¸¸é‡å£°æ˜ | `CONST = 1` (çº¦å®š) | `const x = 1` |
| ä½œç”¨åŸŸ | å‡½æ•°ä½œç”¨åŸŸ + å—çº§ä½œç”¨åŸŸ | å‡½æ•°ä½œç”¨åŸŸ + å—çº§ä½œç”¨åŸŸ |
| å…¨å±€å˜é‡ | `global x` | `window.x` |
| å˜é‡æå‡ | æ—  | æœ‰ (var) |
| æš‚æ—¶æ€§æ­»åŒº | æ—  | æœ‰ (let/const) |

### ä¸»è¦å·®å¼‚

1. **å˜é‡å£°æ˜ï¼š** Python ä¸éœ€è¦æ˜¾å¼å£°æ˜ï¼ŒJavaScript éœ€è¦ `let`/`const`/`var`
2. **å˜é‡æå‡ï¼š** JavaScript æœ‰å˜é‡æå‡æœºåˆ¶ï¼ŒPython æ²¡æœ‰
3. **å¸¸é‡ï¼š** Python æ²¡æœ‰çœŸæ­£çš„å¸¸é‡ï¼ŒJavaScript æœ‰ `const`
4. **ä½œç”¨åŸŸï¼š** Python çš„ `nonlocal` ç±»ä¼¼äº JavaScript çš„é—­åŒ…

## æ€»ç»“

æŒæ¡å˜é‡ä¸ä½œç”¨åŸŸæ˜¯å­¦ä¹ ç°ä»£ JavaScript çš„åŸºç¡€ã€‚å…³é”®è¦ç‚¹ï¼š

1. **ä¼˜å…ˆä½¿ç”¨ `const`**ï¼Œéœ€è¦é‡æ–°èµ‹å€¼æ—¶ä½¿ç”¨ `let`
2. **ç†è§£å—çº§ä½œç”¨åŸŸ**ï¼Œé¿å…å¾ªç¯å’Œæ¡ä»¶è¯­å¥ä¸­çš„å˜é‡é—®é¢˜
3. **é¿å…å…¨å±€å˜é‡æ±¡æŸ“**ï¼Œä½¿ç”¨æ¨¡å—æ¨¡å¼ä¿æŠ¤ç§æœ‰æ•°æ®
4. **æ³¨æ„æš‚æ—¶æ€§æ­»åŒº**ï¼Œä¸è¦åœ¨å£°æ˜å‰ä½¿ç”¨ `let`/`const` å˜é‡
5. **åŠæ—¶æ¸…ç†å¼•ç”¨**ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼

é€šè¿‡æœ¬ç« èŠ‚çš„å­¦ä¹ ï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š
- æ­£ç¡®ä½¿ç”¨ `let`ã€`const`ã€`var`
- ç†è§£å¹¶åº”ç”¨å—çº§ä½œç”¨åŸŸ
- é¿å…å¸¸è§çš„ä½œç”¨åŸŸé™·é˜±
- åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨æœ€ä½³å®è·µ